

title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data
Here, we are loading the original source data and displaying a summary view of the raw data.
```{r echo=TRUE}
library(dplyr)
library(lubridate)
library(ggplot2)
library(qdap)
activity <- read.csv("~/Coursera Files/ReproducibleResearch/activity.csv")
activity <- transform(activity, date = factor(date))
summary(activity)
```

## What is mean total number of steps taken per day?
Here, we see a histogram of the Total Steps Per Day activity plotted.  

```{r echo=TRUE}

totalStepsPerDay <- tapply(activity$steps, activity$date, sum)
stepMean <- mean(totalStepsPerDay, na.rm=TRUE)
stepMedian <- median(totalStepsPerDay, na.rm=TRUE)
hist(totalStepsPerDay,main="Total Steps Per Day", xlab="Total Steps", ylab = "Frequency")

```


The mean value is **`r format(stepMean,3)`** and the median value is **`r format(stepMedian,3)`**. 

## What is the average daily activity pattern?
```{r echo=TRUE}

activity <- transform(activity,interval = factor(interval))
activity <- group_by(activity,interval)
meanStepsPerInterval <- summarise(activity, steps = mean(steps,na.rm=TRUE))
maximumMeanStepsPerInterval <- max(meanStepsPerInterval$steps)
maximumInterval <- meanStepsPerInterval[which.max(meanStepsPerInterval$steps),1]
 plot(levels(as.factor(meanStepsPerInterval$interval)), meanStepsPerInterval$steps, 
      type="l", col="red", 
      main="Daily activity pattern", 
      xlab="Daily Interval", ylab="Number of Steps (mean)")
```

The maximum mean steps value is `r format(maximumMeanStepsPerInterval,1)` and the interval for that is `r format(maximumInterval,0)`. 
Imputing missing values.Here, we are replacing NAs with the mean Steps Per Interval value (as stored in the meanStepsPerInterval table).

## Imputing missing values
```{r echo=TRUE}
 #reset the dataset 
activityNoNA <- activity
missingData <- sum(is.na(activityNoNA))
i<-1
for (i in 1:dim(activityNoNA)[1]){
        if (is.na(activityNoNA[i,1])){
                r<-match(activityNoNA[i,3],meanStepsPerInterval$interval)
                activityNoNA[i,1]<-meanStepsPerInterval[r,2]
                }
        i=i+1
}
activityNoNA <- transform(activityNoNA,interval = factor(interval))
activityNoNA <- group_by(activityNoNA,interval)
stepsPerDay2 <- tapply(activityNoNA$steps, activityNoNA$date, sum, na.rm = TRUE)
stepMean2 <- mean(stepsPerDay2, na.rm=TRUE)
stepMedian2 <- median(stepsPerDay2, na.rm=TRUE)
hist(stepsPerDay2,xlab="Interval", ylab = "Mean Steps per Interval (NAs replaced by mean for interval)")
abline(v=stepMean2, col = "red")
abline(v=stepMedian2, col = "blue")

```

There were `r missingData` records with "NA".  The mean value is **`r format(stepMean2,3)`** and the median value is **`r format(stepMedian2,3)`**. You can see from the chart that the replacing the NA interval values with thier mean skewed the earlier intervals to higher values.  

## Are there differences in activity patterns between weekdays and weekends?

It would appear from the charts below that the activity level tends to be higher on the weekends vs weekdays.  

```{r echo=TRUE}
activityNoNA$weekend = chron::is.weekend(as.Date(activityNoNA$date))
activityNoNA$weekend[activityNoNA$weekend == TRUE] <- "Weekend"
activityNoNA$weekend[activityNoNA$weekend == FALSE] <- "Weekday"

plot_data <- activityNoNA %>% group_by(weekend, interval)  %>% summarize(steps = mean(steps, na.rm=TRUE))
plotTitle = "Mean Steps per Interval (Weekend vs Weekday)"
plotYLab = "Mean Steps"
plotXLab = "Interval"

plot <- ggplot(plot_data, aes(x=interval,y=steps,group=weekend)) + geom_line(aes(color=weekend)) + facet_grid(weekend ~ .) + labs(x=plotXLab, y=plotYLab, title=plotTitle) + scale_x_discrete(breaks=seq(0,3000,500))
print(plot)

```

